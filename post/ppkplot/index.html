<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PopPK绘图 | Kokomo</title>
<link rel="shortcut icon" href="https://kokomole.github.io/favicon.ico?v=1599230976789">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://kokomole.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="PopPK绘图 | Kokomo - Atom Feed" href="https://kokomole.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="1. R包和主题
rm(list = ls())

library(ggplot2)
library(cowplot)
library(GGally)
library(dplyr)
library(xpose4)
library(resha..." />
    <meta name="keywords" content="PopPK,ggplot2" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://kokomole.github.io">
  <img class="avatar" src="https://kokomole.github.io/images/avatar.png?v=1599230976789" alt="">
  </a>
  <h1 class="site-title">
    Kokomo
  </h1>
  <p class="site-description">
    
  </p>
  <div class="menu-container">
    
      
        <a href="/post/home" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
</form>
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/Kokomole" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
        <a href="https://twitter.com/Min_Zhu_" target="_blank">
          <i class="ri-twitter-line"></i>
        </a>
      
    
      
    
      
        <a href="https://www.zhihu.com/people/keytruda-73" target="_blank">
          <i class="ri-zhihu-line"></i>
        </a>
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              PopPK绘图
            </h2>
            <div class="post-info">
              <span>
                2020-08-22
              </span>
              <span>
                20 min read
              </span>
              
                <a href="https://kokomole.github.io/tag/UaOhGznwo/" class="post-tag">
                  # PopPK
                </a>
              
                <a href="https://kokomole.github.io/tag/p-XbLjM2CJ/" class="post-tag">
                  # ggplot2
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="1-r包和主题">1. R包和主题</h1>
<pre><code>rm(list = ls())

library(ggplot2)
library(cowplot)
library(GGally)
library(dplyr)
library(xpose4)
library(reshape)

mytheme &lt;- theme(panel.background = element_blank(),
                 panel.border = element_rect(fill=NA, color = &quot;black&quot;),
                 panel.grid = element_blank(),
                 #panel.grid.major.y = element_line(colour = &quot;grey85&quot;, size = 0.25), 
                 #panel.grid.minor.y = element_line(colour = &quot;grey85&quot;, size = 0.25),
                 plot.title = element_text(hjust = 0.5),
                 plot.subtitle = element_text(hjust = 0.5),
                 plot.caption = element_text(),
                 legend.position = &quot;bottom&quot;,
                 legend.key = element_blank(),
                 strip.background = element_rect(color = &quot;black&quot;))
</code></pre>
<h1 id="2-协变量分布">2. 协变量分布</h1>
<p>协变量分为连续变量和分类变量2种，因此协变量的分布及其相关关系分为以下几种：</p>
<ul>
<li>单个连续变量的分布</li>
<li>单个分类变量的分布</li>
<li>连续变量与连续变量的关系</li>
<li>分类变量与分类变量的关系</li>
<li>连续变量与分类变量的关系</li>
</ul>
<h2 id="21-利用ggally包">2.1 利用GGally包</h2>
<p>GGally包通过一个矩阵表示变量的分布。</p>
<p>矩阵的对角线表示单个变量的分布，在<code>diag</code>中设置：</p>
<ul>
<li>连续变量（<code>continuous</code>）用密度曲线（<code>densityDiag</code>）表示；</li>
<li>分类变量（<code>discrete</code>）用条形图（<code>barDiag</code>）表示。</li>
</ul>
<p>矩阵的上下半区表示变量之间的关系，在<code>upper</code>和<code>lower</code>中设置：</p>
<ul>
<li>连续变量之间（<code>continuous</code>）的关系：上半区用相关系数（<code>cor</code>）表示；下半区用散点图加平滑曲线（<code>smooth_loess</code>）表示；</li>
<li>分类变量之间（<code>discrete</code>）的关系：上半区用比例图（<code>ratio</code>）表示；下半区用分面条形图（<code>facetbar</code>）表示；</li>
<li>连续变量与分类变量之间（<code>combo</code>）的关系：上半区用分面箱型图（<code>box_no_facet</code>）表示；下半区用分面直方图（<code>facethist</code>）表示。</li>
</ul>
<pre><code>ggpairs(dataset, 
        columns =c(&quot;WT&quot;,&quot;BUN&quot;,&quot;ALB&quot;,&quot;SEX&quot;,&quot;CYP3A5&quot;),
        title = &quot;Distribution of covariates&quot;,
        upper = list(continuous = wrap(&quot;cor&quot;, col = &quot;black&quot;, size=4),
                     discrete = wrap(&quot;ratio&quot;, col = &quot;black&quot;, fill = &quot;gray&quot;),
                     combo = wrap(&quot;box_no_facet&quot;)),
        lower = list(continuous = wrap('smooth_loess', col = &quot;gray&quot;, shape = 1, se = F),
                     discrete = wrap(&quot;facetbar&quot;, col = &quot;black&quot;, fill = &quot;black&quot;),
                     combo = wrap(&quot;facethist&quot;), col = &quot;black&quot;, fill = &quot;black&quot;),
        diag = list(continuous = wrap(&quot;densityDiag&quot;, col = &quot;red&quot;, size = 1),
                    discrete = wrap(&quot;barDiag&quot;, col = &quot;red&quot;, fill = &quot;white&quot;, size = 1))) +
  mytheme
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://kokomole.github.io/post-images/1598629706783.png" alt="" loading="lazy"></figure>
<h1 id="3-药时曲线">3. 药时曲线</h1>
<h2 id="31-普通药时曲线">3.1 普通药时曲线</h2>
<pre><code>p &lt;- ggplot(draw, aes(x = TIME, y = DV, group = ID,col = RACE, shape = RACE)) + # 按ID画
  geom_point() +
  geom_line() +
  labs(x = &quot;Time (hrs)&quot;, y = &quot;Concentration (ng/mL)&quot;) +
  # color与shape与aes()里col、shape的变量一致
  scale_color_manual(values = c(&quot;deepskyblue&quot;,&quot;#F8766D&quot;,&quot;aquamarine1&quot;)) +
  scale_shape_manual(values = c(1,1,1)) +
  mytheme
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://kokomole.github.io/post-images/1598629762143.png" alt="" loading="lazy"></figure>
<h2 id="32-分组药时曲线">3.2 分组药时曲线</h2>
<pre><code>p + facet_wrap(~DOSE,nrow = 2)
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://kokomole.github.io/post-images/1598629812172.png" alt="" loading="lazy"></figure>
<h2 id="33-对数药时曲线">3.3 对数药时曲线</h2>
<pre><code>p + facet_wrap(~DOSE,nrow = 2) + 
  scale_y_log10()
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://kokomole.github.io/post-images/1598629845077.png" alt="" loading="lazy"></figure>
<h2 id="34-个体药时曲线">3.4 个体药时曲线</h2>
<p>NM输出的表格第一行会带有<code>TABLE NO. 1</code>，因此读取时第一行要跳过：</p>
<pre><code>data &lt;- read.table(&quot;final.fit&quot;, skip = 1, header = T)
</code></pre>
<pre><code>plot_individual &lt;- function(data, log) {
  p &lt;- ggplot(data) + 
    geom_point(aes(x = TIME, y = DV, col = as.factor(STUDY), shape = as.factor(STUDY))) +
    geom_line(aes(x = TIME, y = IPRED), col = &quot;black&quot;) +
    geom_line(aes(x = TIME, y = PRED), col = &quot;black&quot;, linetype = 2) +
    labs(x = &quot;Time (hrs)&quot;, y = &quot;Observed and predicted concentration (ng/mL)&quot;) +
    scale_color_manual(values = c(&quot;deepskyblue&quot;,&quot;#F8766D&quot;)) +
    scale_shape_manual(values = c(1,1)) +
    ggtitle(&quot;Individual time-concentration curve&quot;) +
    mytheme +
    facet_wrap(~as.factor(ID), nrow = 8)
  if (log==F) {
    p
  } else {
    p + scale_y_log10()
  }
}
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://kokomole.github.io/post-images/1598629876091.png" alt="" loading="lazy"></figure>
<h1 id="3-参数正态性">3. 参数正态性</h1>
<h2 id="31-pk参数的分布">3.1 PK参数的分布</h2>
<p>PopPK可以估计PK参数的变异。将PK参数视为随机变量，假设其服从或经对数变换后服从正态分布：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>∼</mo><mi>N</mi><mo>(</mo><msub><mi>θ</mi><mrow><mi>T</mi><mi>V</mi></mrow></msub><mo separator="true">,</mo><msup><mi>ω</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\theta \sim N(\theta_{TV},\omega^2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>模型会估计出这个正态分布的均值和方差，均值即为参数的群体典型值。将均值去掉之后，参数的个体间变异服从均值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，方差为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>ω</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\omega^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>的正态分布：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi><mo>∼</mo><mi>N</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>ω</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\eta \sim N(0,\omega^2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>参数的变异近似等于该正态分布的标准差：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>V</mi><mi mathvariant="normal">%</mi><mo>≈</mo><mi>ω</mi></mrow><annotation encoding="application/x-tex">CV \% \approx \omega
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord">%</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span></span></span></span>的分布如下：</p>
<figure data-type="image" tabindex="6"><img src="https://kokomole.github.io/post-images/1598031294821.png" alt="" loading="lazy"></figure>
<h2 id="32-参数分布图">3.2 参数分布图</h2>
<pre><code>par_distribution &lt;- function(data, eta, xlab, bin) {
  ggplot() +
    geom_histogram(aes(x = data[,eta],y = ..density..),     
                   binwidth = bin,
                   colour = &quot;black&quot;, fill = &quot;gray&quot;) +
    geom_density(aes(x = data[,eta], y = ..density..),
                 col = &quot;red&quot;, size = 1) +
    labs(x = xlab) +
    mytheme
}

par_distribution(data = data, eta = &quot;ETA2&quot;, xlab = &quot;ETA_Km&quot;, bin = 0.2)
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://kokomole.github.io/post-images/1598629917930.png" alt="" loading="lazy"></figure>
<h1 id="4-参数相关性">4. 参数相关性</h1>
<pre><code>ggpairs(a, columns = c(&quot;ETA1&quot;,&quot;ETA2&quot;),
        upper = list(continuous = wrap(&quot;cor&quot;, col = &quot;black&quot;, size=5)),
        lower = list(continuous = wrap('smooth_loess', col = &quot;blue&quot;, shape = 1, se = F)),
        diag = list(continuous = wrap(&quot;densityDiag&quot;, col = &quot;red&quot;, size = 1))) +
  mytheme
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://kokomole.github.io/post-images/1598629944531.png" alt="" loading="lazy"></figure>
<h1 id="5-参数-协变量相关性">5. 参数-协变量相关性</h1>
<h2 id="51-协变量">5.1 协变量</h2>
<p>针对PK参数的分布，如果我们给其增加一个维度（如体重、基因型等），可能会发现这些值的分布会出现一定的趋势。</p>
<figure data-type="image" tabindex="9"><img src="https://kokomole.github.io/post-images/1598031278700.png" alt="" loading="lazy"></figure>
<p>即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span></span></span></span>的值与体重、基因型等因素具有一定的相关性。如果这样的相关性具有显著的统计学意义，则将这样的因素称为显著协变量。所以画参数 - 协变量图，是为了可视化PK参数（变异）与潜在影响因素的相关性，为协变量的筛选提供参考。</p>
<h2 id="52-连续型协变量">5.2 连续型协变量</h2>
<p>连续变量与参数的关系以散点图呈现，主要包括以下要素：</p>
<ul>
<li>散点：x轴坐标为协变量的值，y轴坐标为参数值（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>L</mi><mi mathvariant="normal">、</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">CL、V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">L</span><span class="mord cjk_fallback">、</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span>等）或参数的变异值（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span></span></span></span>）</li>
<li>回归曲线：通常用loess回归</li>
<li>参考线：y轴为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span></span></span></span>时，以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>为参考线</li>
</ul>
<pre><code>ggplot(data,aes(x = data[,&quot;WT&quot;],y = data[,&quot;ETA1&quot;])) +
  geom_point(shape = 1,col = &quot;blue&quot;) +
  geom_smooth(size = 1,method = &quot;loess&quot;,col = &quot;red&quot;) +
  geom_hline(aes(yintercept = 0),linetype = 2,col = &quot;black&quot;,size = 1) +
  labs(x = &quot;WT&quot;,y = &quot;ETA1&quot;) +
  mytheme
</code></pre>
<figure data-type="image" tabindex="10"><img src="https://kokomole.github.io/post-images/1598031246961.png" alt="" loading="lazy"></figure>
<h2 id="53-分类型协变量">5.3 分类型协变量</h2>
<p>分类变量与参数的关系以并列箱线图呈现，主要包括以下要素：</p>
<ul>
<li>箱体：按协变量的类型并列，为了美观可将errorbar画上</li>
<li>散点：这里的散点是指箱线图上的抖动（jitter），将点画上去可以更好地表现数据的分布特征，尤其是在样本较少的情况下</li>
<li>参考线：y轴为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span></span></span></span>时，以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>为参考线</li>
</ul>
<pre><code>ggplot(data,aes(x=data[,&quot;CYP3A5&quot;],y=data[,&quot;ETA1&quot;])) +
  stat_boxplot(geom = &quot;errorbar&quot;,width = 0.3,col = &quot;red&quot;,size = 1) +
  geom_boxplot(show.legend = F,outlier.shape = 1,col = &quot;red&quot;,size = 1) +
  geom_jitter(width = 0.15,shape = 1,col = &quot;blue&quot;) +
  geom_hline(aes(yintercept = 0),linetype = 2,col = &quot;black&quot;,size = 1) +
  labs(x = &quot;CYP3A5&quot;,y = &quot;ETA1&quot;) +
  mytheme
</code></pre>
<figure data-type="image" tabindex="11"><img src="https://kokomole.github.io/post-images/1598031223914.png" alt="" loading="lazy"></figure>
<h2 id="54-画图函数">5.4 画图函数</h2>
<pre><code>plot_COV &lt;- function(data, cov, eta, ylab, type) {
  if (type==&quot;co&quot;) {
    ggplot(data,aes(x = data[,cov], y = data[,eta])) +
      geom_point(shape = 1, col = &quot;blue&quot;) +
      geom_smooth(size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
      geom_hline(aes(yintercept = 0), linetype = 2, col = &quot;black&quot;, size = 1) +
      labs(x = cov, y = ylab) +
      mytheme
  } else {
    ggplot(data,aes(x = as.factor(data[,cov]), y = data[,eta])) +
    stat_boxplot(geom = &quot;errorbar&quot;, width = 0.3, col = &quot;red&quot;, size = 1) +
    geom_boxplot(show.legend = F, outlier.shape = 1, col = &quot;red&quot;, size = 1) +
    geom_jitter(width = 0.15, shape = 1, col = &quot;blue&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2, col = &quot;black&quot;, size = 1) +
    labs(x = cov, y = ylab) +
    mytheme
  }
}

plot_COV(data,cov = &quot;WT&quot;,eta = &quot;ETA1&quot;,ylab = &quot;ETA_CL&quot;,type = &quot;co&quot;)
</code></pre>
<h2 id="54-数据处理函数">5.4 数据处理函数</h2>
<p><code>par_COV</code>用于对原数据进行整理，如数据范围限定、分类变量设置为因子类型、不同类别的名称设定等。在数据处理完毕后，会调用<code>plot_COV</code>函数进行画图，将所有的图形画好后拼接为一张图。</p>
<pre><code>par_COV &lt;- function(input_file) {
  
  fit &lt;- read.table(input_file, skip = 1, header = T)
  
  # CYP3A5
  fit[which(fit$CYP3A5==1),&quot;CYP3A5&quot;] &lt;- &quot;*1/*1&quot;
  fit[which(fit$CYP3A5==2),&quot;CYP3A5&quot;] &lt;- &quot;*1/*3&quot;
  fit[which(fit$CYP3A5==3),&quot;CYP3A5&quot;] &lt;- &quot;*3/*3&quot;
  fit$CYP3A5 &lt;- as.factor(fit$CYP3A5)
  fit$CYP3A5 &lt;- ordered(fit$CYP3A5, levels = c(&quot;*1/*1&quot;,&quot;*1/*3&quot;,&quot;*3/*3&quot;))
  
  # SEX
  fit[which(fit$SEX==0),&quot;SEX&quot;] &lt;- &quot;Male&quot;
  fit[which(fit$SEX==1),&quot;SEX&quot;] &lt;- &quot;Female&quot;
  fit$SEX &lt;- as.factor(fit$SEX)
  fit$SEX &lt;- ordered(fit$SEX, levels = c(&quot;Male&quot;,&quot;Female&quot;))
  
  p1 &lt;- plot_COV(data = fit, cov = &quot;CYP3A5&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;ca&quot;)
  p2 &lt;- plot_COV(data = fit, cov = &quot;SEX&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;ca&quot;)
  p3 &lt;- plot_COV(data = fit, cov = &quot;DD&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;co&quot;)
  p4 &lt;- plot_COV(data = fit, cov = &quot;WT&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;co&quot;)

  plot_grid(p1,p2,p3,p4, nrow = 3)
}
</code></pre>
<h2 id="55-图形输出">5.5 图形输出</h2>
<p>设定原数据存放路径和画图结果输出路径，设置图片名。调用<code>par_COV</code>函数，将原数据名作为唯一参数，进行画图和结果输出。</p>
<pre><code>setwd(&quot;C:/NMcode/TAC/plot&quot;)  # 图片存放路径
pdf(&quot;1-GOF.pdf&quot;, width = 16, height = 8)
setwd(&quot;C:/NMcode/TAC/model&quot;)  # 原数据存放路径
par_COV(input_file = &quot;1.fit&quot;)
dev.off()
</code></pre>
<figure data-type="image" tabindex="12"><img src="https://kokomole.github.io/post-images/1598031187844.png" alt="" loading="lazy"></figure>
<h2 id="56-将图形画在不同页">5.6 将图形画在不同页</h2>
<pre><code># 图片保存路径
setwd(&quot;C:/NMcode/TAC1/plot&quot;)
pdf(&quot;1-COV-P.pdf&quot;,width = 5,height = 4)

# 数据读取与预处理
setwd(&quot;C:/NMcode/TAC1/model&quot;)
fit &lt;- read.table(&quot;1.fit&quot;, skip = 1, header = T)
# CYP3A5
fit[which(fit$CYP3A5==1),&quot;CYP3A5&quot;] &lt;- &quot;*1/*1&quot;
fit[which(fit$CYP3A5==2),&quot;CYP3A5&quot;] &lt;- &quot;*1/*3&quot;
fit[which(fit$CYP3A5==3),&quot;CYP3A5&quot;] &lt;- &quot;*3/*3&quot;
fit$CYP3A5 &lt;- as.factor(fit$CYP3A5)
fit$CYP3A5 &lt;- ordered(fit$CYP3A5, levels = c(&quot;*1/*1&quot;,&quot;*1/*3&quot;,&quot;*3/*3&quot;))
# SEX
fit[which(fit$SEX==0),&quot;SEX&quot;] &lt;- &quot;Male&quot;
fit[which(fit$SEX==1),&quot;SEX&quot;] &lt;- &quot;Female&quot;
fit$SEX &lt;-as.factor(fit$SEX)
fit$SEX &lt;- ordered(fit$SEX, levels = c(&quot;Male&quot;,&quot;Female&quot;))

# 调用plot_COV()函数画图
plot_COV(data = fit, cov = &quot;CYP3A5&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;ca&quot;)
plot_COV(data = fit, cov = &quot;SEX&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;ca&quot;)
plot_COV(data = fit, cov = &quot;DD&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;co&quot;)
plot_COV(data = fit, cov = &quot;WT&quot;, eta = &quot;ETA1&quot;, ylab = &quot;ETA_CL&quot;, type = &quot;co&quot;)

dev.off()
</code></pre>
<h1 id="6-gof">6. GOF</h1>
<h2 id="61-gof图概述">6.1 GOF图概述</h2>
<p>拟合优度（Goodness of fitness，GOF）图可以显示预测值对实测值的拟合程度。</p>
<p>在对PopPK模型进行评价时，所用的GOF图主要包括以下4个：</p>
<ul>
<li>DV -  PRED</li>
<li>DV - IPRED</li>
<li>CWRES - PRED</li>
<li>CWRES - TIME</li>
</ul>
<p>DV - PRED图和DV - IPRED图属于一类。一般包括以下元素：</p>
<ul>
<li>点：x轴坐标为PRED/IPRED，y轴坐标为DV</li>
<li>回归曲线：通常用loess回归，光滑程度可以用<code>span</code>参数适当调节，可以选择是否显示回归曲线的置信区间</li>
<li>参考线：经过原点的斜率为1的直线</li>
</ul>
<p>将x轴与y轴的范围设为一致，图形会美观一点。</p>
<pre><code>ggplot(data)+
  geom_point(aes(x = PRED,y = DV),shape = 1,col = &quot;blue&quot;) +
  geom_smooth(aes(x = PRED,y = DV),se = F,size = 1,method = &quot;loess&quot;,col = &quot;red&quot;) + 
  geom_abline(slope = 1,linetype = 2,col = &quot;black&quot;) +
  labs(title = &quot;DV - PRED&quot;,x = &quot;PRED&quot;,y = &quot;DV&quot;) +
  xlim(0,10) + ylim(0,10) +
  mytheme 
</code></pre>
<figure data-type="image" tabindex="13"><img src="https://kokomole.github.io/post-images/1598030794716.png" alt="" loading="lazy"></figure>
<p>由于NM数据文件的要求，每行对应不同的事件，因此在多次给药的PK数据中，后面的给药事件对应的DV是0，但实际上是有浓度的。这些点会对画图产生影响，需要去掉。</p>
<pre><code>data &lt;- data[-which(data$DV==0),]
</code></pre>
<figure data-type="image" tabindex="14"><img src="https://kokomole.github.io/post-images/1598030766361.png" alt="" loading="lazy"></figure>
<p>CWRES - PRED图和CWRES - TIME图属于一类。一般包括以下元素：</p>
<ul>
<li>点：x轴坐标为PRED/TIME，y轴坐标为CWRES</li>
<li>回归曲线：通常用loess回归</li>
<li>参考线：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mo>±</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">y=\pm 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">±</span><span class="mord">2</span></span></span></span></li>
</ul>
<p>这2张图不需要限定x轴或y轴的范围。</p>
<pre><code>ggplot(data) +
  geom_point(aes(x = TIME,y = CWRES),shape = 1,col = &quot;blue&quot;) +
  geom_smooth(aes(x = TIME,y = CWRES),se = T,size = 1,method = &quot;loess&quot;,col = &quot;red&quot;) +
  geom_hline(aes(yintercept = 0),linetype = 2) +
  geom_hline(aes(yintercept = -2),linetype = 2) +
  geom_hline(aes(yintercept = 2),linetype = 2) +
  labs(title = &quot;CWRES - TIME&quot;,x = &quot;TIME&quot;,y = &quot;CWRES&quot;) +
  mytheme 
</code></pre>
<figure data-type="image" tabindex="15"><img src="https://kokomole.github.io/post-images/1598030812116.png" alt="" loading="lazy"></figure>
<h2 id="62-画图函数">6.2 画图函数</h2>
<pre><code>plot_GOF &lt;- function(input_file, log){

  data &lt;- read.table(input_file, skip = 1, header = T)
  data &lt;- data[-which(data$DV==0),]
  
  p1 &lt;- ggplot(data,aes(x = PRED, y = DV)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +  
    geom_abline(slope = 1, linetype = 2, col = &quot;black&quot;) +
    labs(x = &quot;PRED&quot;, y = &quot;DV&quot;) +
    xlim(0,10) + ylim(0,10) +
    mytheme 

  p2 &lt;- ggplot(data, aes(x = IPRED, y = DV)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_abline(slope = 1, linetype = 2) +
    labs(x = &quot;IPRED&quot;, y = &quot;DV&quot;) +
    xlim(0,10) + ylim(0,10) +
    mytheme 

  p3 &lt;- ggplot(data,aes(x = PRED, y = CWRES)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2) +
    geom_hline(aes(yintercept = -2), linetype = 2) +
    geom_hline(aes(yintercept = 2), linetype = 2) +
    labs(x = &quot;PRED&quot;, y = &quot;CWRES&quot;) +
    mytheme 

  p4 &lt;- ggplot(data, aes(x = TIME, y = CWRES)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept=0), linetype = 2) +
    geom_hline(aes(yintercept=-2), linetype = 2) +
    geom_hline(aes(yintercept=2), linetype = 2) +
    labs(x = &quot;TIME&quot;, y = &quot;CWRES&quot;) +
   mytheme 
  
  if (log==F) {
    plot_grid(p1,p2,p3,p4, ncol = 2, labels = LETTERS[1:4])
  } else {
    p1 &lt;- p1 + scale_x_log10() + scale_y_log10()
    p2 &lt;- p2 + scale_x_log10() + scale_y_log10()
    p3 &lt;- p3 + scale_x_log10() 
    p4 &lt;- p4 + scale_x_log10()
    plot_grid(p1,p2,p3,p4, ncol = 2, labels = LETTERS[1:4])
  }
}

plot_GOF(input_file = &quot;final.fit&quot;, log = T)
</code></pre>
<figure data-type="image" tabindex="16"><img src="https://kokomole.github.io/post-images/1598030876823.png" alt="" loading="lazy"></figure>
<h2 id="63-分组gof图">6.3 分组GOF图</h2>
<p>在某些情况下，如药物浓度含有总浓度和游离浓度，或纳入了来自不同来源的试验数据等，数据的模型拟合是同时进行的，但想看一下这些亚组各自的拟合效果，则需要对不同的实测值、预测值分别画GOF图。</p>
<p>区分的方法主要有2种：</p>
<ul>
<li>画在同一张图里，用颜色、形状等区分</li>
<li>画在不同的图里</li>
</ul>
<h3 id="631-使用颜色区分">6.3.1 使用颜色区分</h3>
<p>区分变量为<code>FLAG</code>，它必须是一个向量。</p>
<pre><code>plot_GOF_color &lt;- function(input_file){
  
  data &lt;- read.table(input_file, skip = 1, header = T)
  data &lt;- data[-which(data$DV==0),]
  data[,&quot;FLAG&quot;] &lt;- as.factor(data[,&quot;FLAG&quot;])
  
  p1 &lt;- ggplot(data,aes(x = PRED, y = DV, col = FLAG)) +
    geom_point(shape = 1) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_abline(slope = 1,linetype = 2)+
    labs(x = &quot;PRED&quot;, y = &quot;DV&quot;) +
    mytheme + xlim(0,160) + ylim(0,160) +
    scale_color_manual(values = c(&quot;blue&quot;,&quot;red&quot;),
                       name = &quot;VPA concentraion&quot;,
                       labels = c(&quot;total&quot;,&quot;unbound&quot;))
  
  p2 &lt;- ggplot(data,aes(x = IPRED, y = DV, col = FLAG)) +
    geom_point(shape = 1) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_abline(slope = 1, linetype = 2) +
    labs(x = &quot;IPRED&quot;, y = &quot;DV&quot;) +
    mytheme + xlim(0,160) + ylim(0,160) +
    scale_color_manual(values = c(&quot;blue&quot;,&quot;red&quot;),
                       name = &quot;VPA concentraion&quot;,
                       labels = c(&quot;total&quot;,&quot;unbound&quot;))
  
  p3 &lt;- ggplot(data,aes(x = PRED, y = CWRES, col = FLAG)) +
    geom_point(shape = 1) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2) +
    geom_hline(aes(yintercept = -2), linetype = 2) +
    geom_hline(aes(yintercept = 2), linetype = 2) +
    labs(x = &quot;PRED&quot;, y = &quot;CWRES&quot;) +
    mytheme +
    scale_color_manual(values = c(&quot;blue&quot;,&quot;red&quot;),
                       name = &quot;VPA concentraion&quot;,
                       labels = c(&quot;total&quot;, &quot;unbound&quot;))
  
  p4 &lt;- ggplot(data,aes(x = TIME, y = CWRES, col = FLAG)) +
    geom_point(shape = 1) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2) +
    geom_hline(aes(yintercept = -2), linetype = 2) +
    geom_hline(aes(yintercept = 2), linetype = 2) +
    labs(x = &quot;Time&quot;,y = &quot;CWRES&quot;) +
    mytheme + 
    scale_color_manual(values = c(&quot;blue&quot;,&quot;red&quot;),
                       name = &quot;VPA concentraion&quot;,
                       labels = c(&quot;total&quot;, &quot;unbound&quot;))
  
  plot_grid(p1,p2,p3,p4, ncol = 2, labels = LETTERS[1:4])
}
</code></pre>
<figure data-type="image" tabindex="17"><img src="https://kokomole.github.io/post-images/1598030892704.png" alt="" loading="lazy"></figure>
<h3 id="632-画在不同的图中">6.3.2 画在不同的图中</h3>
<pre><code>plot_GOF &lt;- function(input_file){
  
  data &lt;- read.table(input_file, skip = 1, header = T)
  data &lt;- data[-which(data$DV==0),]
  data[,&quot;FLAG&quot;] &lt;- as.factor(data[,&quot;FLAG&quot;])
  
  p1 &lt;- ggplot(data,aes(x = PRED, y = DV)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;)+
    geom_abline(slope = 1, linetype = 2) +
    labs(x=&quot;PRED&quot;, y=&quot;DV&quot;) +
    mytheme +
    facet_wrap(~FLAG, scales = &quot;free&quot;)
  
  p2 &lt;- ggplot(data,aes(x = IPRED, y = DV)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_abline(slope = 1, linetype = 2) +
    labs(x=&quot;IPRED&quot;, y=&quot;DV&quot;)+
    mytheme + 
    facet_wrap(~FLAG, scales = &quot;free&quot;)
  
  p3 &lt;- ggplot(data,aes(x = PRED, y = CWRES)) +
    geom_point(shape = 1, col = &quot;blue&quot;) +
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2) +
    geom_hline(aes(yintercept = -2), linetype = 2) +
    geom_hline(aes(yintercept = 2), linetype = 2) +
    labs(x=&quot;PRED&quot;, y=&quot;CWRES&quot;) +
    mytheme + 
    facet_wrap(~FLAG, scales = &quot;free&quot;)
  
  p4 &lt;- ggplot(data,aes(x = TIME, y = CWRES)) +
    geom_point(shape = 1, col = &quot;blue&quot;)+
    geom_smooth(se = F, size = 1, method = &quot;loess&quot;, col = &quot;red&quot;) +
    geom_hline(aes(yintercept = 0), linetype = 2) + 
    geom_hline(aes(yintercept = -2), linetype = 2) +
    geom_hline(aes(yintercept = 2), linetype = 2) +
    labs(x = &quot;TIME&quot;, y = &quot;CWRES&quot;) +
    mytheme +
    facet_wrap(~FLAG, scales = &quot;free&quot;)
  
  plot_grid(p1,p2,p3,p4, ncol = 2, labels = LETTERS[1:4])
}
</code></pre>
<figure data-type="image" tabindex="18"><img src="https://kokomole.github.io/post-images/1598030906062.png" alt="" loading="lazy"></figure>
<h1 id="7-npde">7. NPDE</h1>
<h1 id="8-vpc">8. VPC</h1>
<h1 id="9-预测误差">9. 预测误差</h1>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#1-r%E5%8C%85%E5%92%8C%E4%B8%BB%E9%A2%98">1. R包和主题</a></li>
<li><a href="#2-%E5%8D%8F%E5%8F%98%E9%87%8F%E5%88%86%E5%B8%83">2. 协变量分布</a>
<ul>
<li><a href="#21-%E5%88%A9%E7%94%A8ggally%E5%8C%85">2.1 利用GGally包</a></li>
</ul>
</li>
<li><a href="#3-%E8%8D%AF%E6%97%B6%E6%9B%B2%E7%BA%BF">3. 药时曲线</a>
<ul>
<li><a href="#31-%E6%99%AE%E9%80%9A%E8%8D%AF%E6%97%B6%E6%9B%B2%E7%BA%BF">3.1 普通药时曲线</a></li>
<li><a href="#32-%E5%88%86%E7%BB%84%E8%8D%AF%E6%97%B6%E6%9B%B2%E7%BA%BF">3.2 分组药时曲线</a></li>
<li><a href="#33-%E5%AF%B9%E6%95%B0%E8%8D%AF%E6%97%B6%E6%9B%B2%E7%BA%BF">3.3 对数药时曲线</a></li>
<li><a href="#34-%E4%B8%AA%E4%BD%93%E8%8D%AF%E6%97%B6%E6%9B%B2%E7%BA%BF">3.4 个体药时曲线</a></li>
</ul>
</li>
<li><a href="#3-%E5%8F%82%E6%95%B0%E6%AD%A3%E6%80%81%E6%80%A7">3. 参数正态性</a>
<ul>
<li><a href="#31-pk%E5%8F%82%E6%95%B0%E7%9A%84%E5%88%86%E5%B8%83">3.1 PK参数的分布</a></li>
<li><a href="#32-%E5%8F%82%E6%95%B0%E5%88%86%E5%B8%83%E5%9B%BE">3.2 参数分布图</a></li>
</ul>
</li>
<li><a href="#4-%E5%8F%82%E6%95%B0%E7%9B%B8%E5%85%B3%E6%80%A7">4. 参数相关性</a></li>
<li><a href="#5-%E5%8F%82%E6%95%B0-%E5%8D%8F%E5%8F%98%E9%87%8F%E7%9B%B8%E5%85%B3%E6%80%A7">5. 参数-协变量相关性</a>
<ul>
<li><a href="#51-%E5%8D%8F%E5%8F%98%E9%87%8F">5.1 协变量</a></li>
<li><a href="#52-%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%8D%8F%E5%8F%98%E9%87%8F">5.2 连续型协变量</a></li>
<li><a href="#53-%E5%88%86%E7%B1%BB%E5%9E%8B%E5%8D%8F%E5%8F%98%E9%87%8F">5.3 分类型协变量</a></li>
<li><a href="#54-%E7%94%BB%E5%9B%BE%E5%87%BD%E6%95%B0">5.4 画图函数</a></li>
<li><a href="#54-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0">5.4 数据处理函数</a></li>
<li><a href="#55-%E5%9B%BE%E5%BD%A2%E8%BE%93%E5%87%BA">5.5 图形输出</a></li>
<li><a href="#56-%E5%B0%86%E5%9B%BE%E5%BD%A2%E7%94%BB%E5%9C%A8%E4%B8%8D%E5%90%8C%E9%A1%B5">5.6 将图形画在不同页</a></li>
</ul>
</li>
<li><a href="#6-gof">6. GOF</a>
<ul>
<li><a href="#61-gof%E5%9B%BE%E6%A6%82%E8%BF%B0">6.1 GOF图概述</a></li>
<li><a href="#62-%E7%94%BB%E5%9B%BE%E5%87%BD%E6%95%B0">6.2 画图函数</a></li>
<li><a href="#63-%E5%88%86%E7%BB%84gof%E5%9B%BE">6.3 分组GOF图</a>
<ul>
<li><a href="#631-%E4%BD%BF%E7%94%A8%E9%A2%9C%E8%89%B2%E5%8C%BA%E5%88%86">6.3.1 使用颜色区分</a></li>
<li><a href="#632-%E7%94%BB%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%9B%BE%E4%B8%AD">6.3.2 画在不同的图中</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#7-npde">7. NPDE</a></li>
<li><a href="#8-vpc">8. VPC</a></li>
<li><a href="#9-%E9%A2%84%E6%B5%8B%E8%AF%AF%E5%B7%AE">9. 预测误差</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://kokomole.github.io/post/FIH/">
              <h3 class="post-title">
                FIH
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  
  <a class="rss" href="https://kokomole.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
